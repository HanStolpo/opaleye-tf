<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Opaleye.TF</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Opaleye-TF.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">opaleye-tf-0.1.0.0: A client library for Opaleye using type families</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Opaleye.TF</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Mapping PostgreSQL types</a></li><li><a href="#g:2">Defining tables</a></li><li><a href="#g:3">Querying tables</a></li><li><a href="#g:4">Inserting data</a></li><li><a href="#g:5">Implementation details</a></li></ul></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type family</span> <a href="#t:Col">Col</a> f x :: b</li><li class="src short"><span class="keyword">data</span> <a href="#t:PGTypes">PGTypes</a><ul class="subs"><li>= <a href="#v:PGBigint">PGBigint</a></li><li>| <a href="#v:PGText">PGText</a></li><li>| <a href="#v:PGBoolean">PGBoolean</a></li><li>| <a href="#v:PGNull">PGNull</a> <a href="Opaleye-TF.html#t:PGTypes">PGTypes</a></li><li>| <a href="#v:PGReal">PGReal</a></li><li>| <a href="#v:PGTimestampWithoutTimeZone">PGTimestampWithoutTimeZone</a></li><li>| <a href="#v:PGInteger">PGInteger</a></li><li>| <a href="#v:PGDefault">PGDefault</a> <a href="Opaleye-TF.html#t:PGTypes">PGTypes</a></li></ul></li><li class="src short"><span class="keyword">class</span> (haskell ~ Apply <a href="Opaleye-TF.html#t:InterpretPGType">InterpretPGType</a> pg) =&gt; <a href="#t:Lit">Lit</a> pg haskell | haskell -&gt; pg, pg -&gt; haskell <span class="keyword">where</span><ul class="subs"><li><a href="#v:lit">lit</a> :: haskell -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> pg</li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Table">Table</a> tableName columnType = <a href="#v:Column">Column</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-String.html#t:String">String</a></li><li class="src short"><a href="#v:queryTable">queryTable</a> :: <span class="keyword">forall</span> table tableName. (<a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/GHC-TypeLits.html#t:KnownSymbol">KnownSymbol</a> tableName, TableLike table tableName) =&gt; table (<a href="Opaleye-TF.html#t:Table">Table</a> tableName) -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> (table <a href="Opaleye-TF.html#t:Expr">Expr</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Expr">Expr</a> columnType</li><li class="src short"><a href="#v:select">select</a> :: Selectable pg haskell =&gt; <a href="file:///nix/store/2sbd0wn0vwdsl2qnzdj2yw1lz21n3fhh-postgresql-simple-0.4.10.0/share/doc/x86_64-linux-ghc-7.10.2/postgresql-simple-0.4.10.0/html/Database-PostgreSQL-Simple-Internal.html#t:Connection">Connection</a> -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> pg -&gt; <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/System-IO.html#t:IO">IO</a> [haskell]</li><li class="src short"><a href="#v:leftJoin">leftJoin</a> :: ToNull right nullRight =&gt; (left -&gt; right -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a>) -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> left -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> right -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> (left, nullRight)</li><li class="src short"><a href="#v:restrict">restrict</a> :: <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:QueryArr">QueryArr</a> (<a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a>) ()</li><li class="src short"><a href="#v:-61--61-.">(==.)</a> :: <a href="Opaleye-TF.html#t:Expr">Expr</a> a -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> a -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a></li><li class="src short"><a href="#v:insert">insert</a> :: Insertable table row =&gt; <a href="file:///nix/store/2sbd0wn0vwdsl2qnzdj2yw1lz21n3fhh-postgresql-simple-0.4.10.0/share/doc/x86_64-linux-ghc-7.10.2/postgresql-simple-0.4.10.0/html/Database-PostgreSQL-Simple-Internal.html#t:Connection">Connection</a> -&gt; table -&gt; [row] -&gt; <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Int.html#t:Int64">Int64</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Insertion">Insertion</a> :: k -&gt; *</li><li class="src short"><span class="keyword">data</span> <a href="#t:Default">Default</a> a<ul class="subs"><li>= <a href="#v:Default">Default</a></li><li>| <a href="#v:ProvideValue">ProvideValue</a> a</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Compose">Compose</a> f g a = <a href="#v:Compose">Compose</a> (f (g a))</li><li class="src short"><span class="keyword">data</span> <a href="#t:InterpretPGType">InterpretPGType</a> :: TyFun <a href="Opaleye-TF.html#t:PGTypes">PGTypes</a> * -&gt; *</li><li class="src short"><span class="keyword">data</span> <a href="#t:InterpretNull">InterpretNull</a> :: k -&gt; *</li><li class="src short"><span class="keyword">data</span> <a href="#t:Interpret">Interpret</a> :: k -&gt; *</li></ul></div><div id="interface"><h1>Documentation</h1><div class="doc"><p>Welcome to <code>opaleye-tf</code>, a library to query and interact with PostgreSQL
databases. As the name suggests, this library builds on top of the terrific
<code>opaleye</code> library, but provides a different API that the author believes
provides more succinct code with better type inference.</p><p>The basic idea behind <code>opaleye-tf</code> is to &quot;pivot&quot; around the ideas in
<code>opaleye</code>. The current idiomatic usage of Opaleye is to define your records as
data types where each field is parameterized. Opaleye then varies all of these
parameters together. <code>opaleye-tf</code> makes the observation that if all of these
vary uniformly, then there should only be <em>one</em> parameter, and thus we have
records that are parameterized by functors.</p><p>To take an example, let's consider a simple schema for Hackage - the repository
of Haskell libraries.</p><pre>data Package f =
  Package { packageName :: <code><a href="Opaleye-TF.html#t:Col">Col</a></code> f <code><a href="Opaleye-TF.html#v:PGText">PGText</a></code>
          , packageAuthor :: Col f '<code><a href="Opaleye-TF.html#v:PGInteger">PGInteger</a></code>
          , packageMaintainerId :: Col f ('<code><a href="Opaleye-TF.html#v:PGNull">PGNull</a></code> '<code><a href="Opaleye-TF.html#v:PGInteger">PGInteger</a></code>)
          }

data User f =
  User { userId :: <code><a href="Opaleye-TF.html#t:Col">Col</a></code> f '<code><a href="Opaleye-TF.html#v:PGInteger">PGInteger</a></code>
       , userName :: <code><a href="Opaleye-TF.html#t:Col">Col</a></code> f '<code><a href="Opaleye-TF.html#v:PGText">PGText</a></code>
       , userBio :: <code><a href="Opaleye-TF.html#t:Col">Col</a></code> f ('<code><a href="Opaleye-TF.html#v:PGNull">PGNull</a></code> <code><a href="Opaleye-TF.html#v:PGText">PGText</a></code>)
       }
</pre><p>In this example, each record (<code>Package</code> and <code>User</code>) correspond to tables in a
PostgreSQL database. These records are parameterized over functors <code>f</code>, which
will provide <em>meaning</em> depending on how the record is used. Notice all that
we specify the types as they are in PostgreSQL. <code>opaleye-tf</code> primarily focuses
on the flow of information <em>from</em> the database.</p><p>One type of meaning that we can give to tables is to map their fields to their
respective columns. This is done by choosing <code><a href="Opaleye-TF.html#t:Table">Table</a></code> as our choice of <code>f</code>:</p><pre>packageTable :: Package (<code><a href="Opaleye-TF.html#t:Table">Table</a></code> &quot;package&quot;)
packageTable = Package { packageName = &quot;name&quot;
                       , packageAuthor = &quot;author_id&quot;
                       , packageMaintainerId = &quot;maintainer_id&quot; }

userTable :: User (<code><a href="Opaleye-TF.html#t:Table">Table</a></code> &quot;user&quot;)
userTable = User { userId = &quot;id&quot;
                 , userName = &quot;name&quot;
                 , userBio = &quot;bio&quot;
                 }
</pre><p>Now that we have full definitions of our tables, we can perform some <code>SELECT</code>s.
First, let's list all known packages:</p><pre>listAllPackages :: <code><a href="file:///nix/store/2sbd0wn0vwdsl2qnzdj2yw1lz21n3fhh-postgresql-simple-0.4.10.0/share/doc/x86_64-linux-ghc-7.10.2/postgresql-simple-0.4.10.0/html/Database-PostgreSQL-Simple-Internal.html#t:Connection">Connection</a></code> -&gt; IO [Package <code><a href="Opaleye-TF.html#t:Interpret">Interpret</a></code>]
listAllPackages c = <code><a href="Opaleye-TF.html#v:select">select</a></code> (<code><a href="Opaleye-TF.html#v:queryTable">queryTable</a></code> packageTable)
</pre><p>This computation now returns us a list of <code>Package</code>s where <code>f</code> has been set as
<code><a href="Opaleye-TF.html#t:Interpret">Interpret</a></code>. The <code><a href="Opaleye-TF.html#t:Interpret">Interpret</a></code> functor is responsible for defining the mapping
from PostgreSQL types (such as <code><a href="Opaleye-TF.html#v:PGText">PGText</a></code>) to Haskell types (such as <code><a href="file:///nix/store/fr6i9v6mingb7wrb4gynj8l80i1jryxp-text-1.2.1.3/share/doc/x86_64-linux-ghc-7.10.2/text-1.2.1.3/html/Data-Text.html#t:Text">Text</a></code>).</p><p>Another choice of <code>f</code> occurs when we perform a left join. For example, here
is the <em>query</em> to list all packages with their (optional) maintainers:</p><pre>listAllPackagesAndMaintainersQuery :: <code>Query</code> (Package <code><a href="Opaleye-TF.html#t:Expr">Expr</a></code>, User (<code><a href="Opaleye-TF.html#t:Compose">Compose</a></code> <code><a href="Opaleye-TF.html#t:Expr">Expr</a></code> <code><a href="Opaleye-TF.html#v:PGNull">PGNull</a></code>))
listAllPackagesAndMaintainersQuery =
  <code><a href="Opaleye-TF.html#v:leftJoin">leftJoin</a></code> (p m -&gt; packageMaintainerId p <code><a href="Opaleye-TF.html#v:-61--61-.">==.</a></code> userId m)
           (<code><a href="Opaleye-TF.html#v:queryTable">queryTable</a></code> package)
           (<code><a href="Opaleye-TF.html#v:queryTable">queryTable</a></code> user))
</pre><p>This query communicates that we will have a collection of <code><a href="Opaleye-TF.html#t:Expr">Expr</a></code>essions that
correspond to columns in the <code>Package</code> table, and also a collection of
<code><a href="Opaleye-TF.html#t:Expr">Expr</a></code>essions that are columns in the <code>User</code> table. However, as the user table
is only present as a left join, all of these columns might be <code>NULL</code> - indicated
by the composition of <code><a href="Opaleye-TF.html#v:PGNull">PGNull</a></code> with <code><a href="Opaleye-TF.html#t:Expr">Expr</a></code>.</p><p><code>opaleye-tf</code> is smart enough to collapse data together where convenient.
For example, if we look at just the final types of <code>userId</code> and <code>userBio</code> in the
context of the left join:</p><pre>&gt; :t fmap (\(_, u) -&gt; userId u) listAllPackagesAndMaintainersQuery
Query (Expr (PGNull PGInteger))

&gt; :t fmap (\(_, u) -&gt; userBio u) listAllPackagesAndMaintainersQuery
Query (Expr (PGNull PGText))
</pre><p>Which are as expected.</p><p>Finally, when executing queries that contain left joins, <code>opaleye-tf</code> is able to
invert the possible <code>NULLs</code> over the whole record:</p><pre>&gt; :t conn -&gt; select conn listAllPackagesAndMaintainersQuery
Connection -&gt; IO [(Package Interpret, Maybe (User Interpret))]
</pre><p>Notice that <code>User (Compose Expr PGNull)</code> was mapped to <code>Maybe (User Interpret)</code>.</p></div><div class="top"><p class="src"><span class="keyword">type family</span> <a name="t:Col" class="def">Col</a> f x :: b</p><div class="doc"><p>The workhorse type family in <code>opaleye-tf</code>. This type family &quot;collapses&quot;
 noisy types down into things that are more meaningful. For example, when
 used with <code><a href="Opaleye-TF.html#t:Interpret">Interpret</a></code> you just get ordinary Haskell values.</p></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> <a href="Opaleye-TF.html#t:Interpret">Interpret</a> x = Apply <a href="Opaleye-TF.html#t:InterpretPGType">InterpretPGType</a> x</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> <a href="Opaleye-TF.html#t:Insertion">Insertion</a> (<a href="Opaleye-TF.html#v:PGDefault">PGDefault</a> t) = <a href="Opaleye-TF.html#t:Default">Default</a> (<a href="Opaleye-TF.html#t:Expr">Expr</a> t)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> <a href="Opaleye-TF.html#t:Insertion">Insertion</a> x = <a href="Opaleye-TF.html#t:Expr">Expr</a> x</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> (<a href="Opaleye-TF.html#t:Compose">Compose</a> <a href="Opaleye-TF.html#t:Interpret">Interpret</a> <a href="Opaleye-TF.html#v:PGNull">PGNull</a>) (<a href="Opaleye-TF.html#v:PGNull">PGNull</a> t) = <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (Apply <a href="Opaleye-TF.html#t:InterpretPGType">InterpretPGType</a> t)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> (<a href="Opaleye-TF.html#t:Compose">Compose</a> <a href="Opaleye-TF.html#t:Interpret">Interpret</a> <a href="Opaleye-TF.html#v:PGNull">PGNull</a>) x = <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Opaleye-TF.html#t:Col">Col</a> <a href="Opaleye-TF.html#t:Interpret">Interpret</a> x)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> (<a href="Opaleye-TF.html#t:Compose">Compose</a> <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGNull">PGNull</a>) (<a href="Opaleye-TF.html#v:PGNull">PGNull</a> t) = <a href="Opaleye-TF.html#t:Col">Col</a> (<a href="Opaleye-TF.html#t:Compose">Compose</a> <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGNull">PGNull</a>) t</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> (<a href="Opaleye-TF.html#t:Compose">Compose</a> <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGNull">PGNull</a>) t = <a href="Opaleye-TF.html#t:Col">Col</a> <a href="Opaleye-TF.html#t:Expr">Expr</a> (<a href="Opaleye-TF.html#v:PGNull">PGNull</a> t)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Opaleye-TF.html#t:Col">Col</a> f x = f x</td><td class="doc empty">&nbsp;</td></tr></table></div></div><h1 id="g:1">Mapping PostgreSQL types</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:PGTypes" class="def">PGTypes</a></p><div class="doc"><p>The universe of types known about by PostgreSQL.</p><p>Note that this data type is a little too large, in that it's possible to have
 types such as <code>PGNull (PGNull PGInteger)</code> which doesn't make much sense, so
 you'll need to be slightly careful!</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:PGBigint" class="def">PGBigint</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGText" class="def">PGText</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGBoolean" class="def">PGBoolean</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGNull" class="def">PGNull</a> <a href="Opaleye-TF.html#t:PGTypes">PGTypes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGReal" class="def">PGReal</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGTimestampWithoutTimeZone" class="def">PGTimestampWithoutTimeZone</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGInteger" class="def">PGInteger</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:PGDefault" class="def">PGDefault</a> <a href="Opaleye-TF.html#t:PGTypes">PGTypes</a></td><td class="doc"><p>Used to indicate that columns may also take an extra value - <code>DEFAULT</code>.</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">class</span> (haskell ~ Apply <a href="Opaleye-TF.html#t:InterpretPGType">InterpretPGType</a> pg) =&gt; <a name="t:Lit" class="def">Lit</a> pg haskell | haskell -&gt; pg, pg -&gt; haskell <span class="keyword">where</span></p><div class="doc"><p>A class witnessing the relationship between PostgreSQL types and their
 Haskell representations.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:lit" class="def">lit</a> :: haskell -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> pg</p><div class="doc"><p>Given a Haskell value, build an <code><a href="Opaleye-TF.html#t:Expr">Expr</a></code> that represents this value as a
 PostgreSQL literal.</p></div></div><div class="subs instances"><p id="control.i:Lit" class="caption collapser" onclick="toggleSection('i:Lit')">Instances</p><div id="section.i:Lit" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> <a href="Opaleye-TF.html#v:PGBigint">PGBigint</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Int.html#t:Int64">Int64</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> <a href="Opaleye-TF.html#v:PGText">PGText</a> <a href="file:///nix/store/fr6i9v6mingb7wrb4gynj8l80i1jryxp-text-1.2.1.3/share/doc/x86_64-linux-ghc-7.10.2/text-1.2.1.3/html/Data-Text.html#t:Text">Text</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Bool.html#t:Bool">Bool</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> <a href="Opaleye-TF.html#v:PGReal">PGReal</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Prelude.html#t:Float">Float</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> <a href="Opaleye-TF.html#v:PGTimestampWithoutTimeZone">PGTimestampWithoutTimeZone</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/time-1.5.0.1/Data-Time-LocalTime.html#t:LocalTime">LocalTime</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> <a href="Opaleye-TF.html#v:PGInteger">PGInteger</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Int.html#t:Int32">Int32</a></span></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="Opaleye-TF.html#t:Lit">Lit</a> t t' =&gt; <a href="Opaleye-TF.html#t:Lit">Lit</a> (<a href="Opaleye-TF.html#v:PGNull">PGNull</a> t) (<a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Maybe.html#t:Maybe">Maybe</a> t')</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Defining tables</h1><div class="top"><p class="src"><span class="keyword">newtype</span> <a name="t:Table" class="def">Table</a> tableName columnType</p><div class="doc"><p><code><a href="Opaleye-TF.html#t:Table">Table</a></code> is used to specify the schema definition in PostgreSQL. The type
 itself uses a GHC &quot;symbol&quot; to specify the table name. This is also an
 instance of <code>FromString</code>, where the string is taken as the column name.</p><p>Example:</p><pre>userTable :: User (<code><a href="Opaleye-TF.html#t:Table">Table</a></code> &quot;user&quot;)
userTable = User { userId = &quot;id&quot;
                 , userName = &quot;name&quot;
                 , userBio = &quot;bio&quot;
                 }
</pre></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Column" class="def">Column</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-String.html#t:String">String</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Table" class="caption collapser" onclick="toggleSection('i:Table')">Instances</p><div id="section.i:Table" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-String.html#t:IsString">IsString</a> (<a href="Opaleye-TF.html#t:Table">Table</a> k tableName columnType)</span></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:3">Querying tables</h1><div class="top"><p class="src"><a name="v:queryTable" class="def">queryTable</a> :: <span class="keyword">forall</span> table tableName. (<a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/GHC-TypeLits.html#t:KnownSymbol">KnownSymbol</a> tableName, TableLike table tableName) =&gt; table (<a href="Opaleye-TF.html#t:Table">Table</a> tableName) -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> (table <a href="Opaleye-TF.html#t:Expr">Expr</a>)</p><div class="doc"><p><code><a href="Opaleye-TF.html#v:queryTable">queryTable</a></code> moves from <code><a href="Opaleye-TF.html#t:Table">Table</a></code> to <code><a href="Opaleye-TF.html#t:Expr">Expr</a></code>. Accessing the fields of your
 table record will now give you expressions to view data in the individual
 columns.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Expr" class="def">Expr</a> columnType</p><div class="doc"><p>A single PostgreSQL expression of a given type.</p></div></div><div class="top"><p class="src"><a name="v:select" class="def">select</a> :: Selectable pg haskell =&gt; <a href="file:///nix/store/2sbd0wn0vwdsl2qnzdj2yw1lz21n3fhh-postgresql-simple-0.4.10.0/share/doc/x86_64-linux-ghc-7.10.2/postgresql-simple-0.4.10.0/html/Database-PostgreSQL-Simple-Internal.html#t:Connection">Connection</a> -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> pg -&gt; <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/System-IO.html#t:IO">IO</a> [haskell]</p><div class="doc"><p><code><a href="Opaleye-TF.html#v:select">select</a></code> executes a PostgreSQL query as a <code>SELECT</code> statement, returning
 data mapped to Haskell values.</p></div></div><div class="top"><p class="src"><a name="v:leftJoin" class="def">leftJoin</a> :: ToNull right nullRight =&gt; (left -&gt; right -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a>) -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> left -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> right -&gt; <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:Query">Query</a> (left, nullRight)</p><div class="doc"><p>A left join takes two queries and performs a relational <code>LEFT JOIN</code> between
 them. The left join has all rows of the left query, joined against zero or
 more rows in the right query. If the join matches no rows in the right table,
 then all columns will be <code>null</code>.</p></div></div><div class="top"><p class="src"><a name="v:restrict" class="def">restrict</a> :: <a href="file:///nix/store/2hh9kf3a8rc6jbg55n27yj10rirn3h3s-opaleye-0.4.2.0/share/doc/x86_64-linux-ghc-7.10.2/opaleye-0.4.2.0/html/Opaleye-Internal-QueryArr.html#t:QueryArr">QueryArr</a> (<a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a>) ()</p><div class="doc"><p>Apply a <code>WHERE</code> restriction to a table.</p></div></div><div class="top"><p class="src"><a name="v:-61--61-." class="def">(==.)</a> :: <a href="Opaleye-TF.html#t:Expr">Expr</a> a -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> a -&gt; <a href="Opaleye-TF.html#t:Expr">Expr</a> <a href="Opaleye-TF.html#v:PGBoolean">PGBoolean</a> <span class="fixity">infix 4</span><span class="rightedge"></span></p><div class="doc"><p>The PostgreSQL <code>=</code> operator.</p></div></div><h1 id="g:4">Inserting data</h1><div class="top"><p class="src"><a name="v:insert" class="def">insert</a> :: Insertable table row =&gt; <a href="file:///nix/store/2sbd0wn0vwdsl2qnzdj2yw1lz21n3fhh-postgresql-simple-0.4.10.0/share/doc/x86_64-linux-ghc-7.10.2/postgresql-simple-0.4.10.0/html/Database-PostgreSQL-Simple-Internal.html#t:Connection">Connection</a> -&gt; table -&gt; [row] -&gt; <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/System-IO.html#t:IO">IO</a> <a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Int.html#t:Int64">Int64</a></p><div class="doc"><p>Given a <code><a href="Opaleye-TF.html#t:Table">Table</a></code> and a collection of rows for that table, <code>INSERT</code> this data
 into PostgreSQL. The rows are specified as PostgreSQL expressions.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Insertion" class="def">Insertion</a> :: k -&gt; *</p><div class="doc"><p><code><a href="Opaleye-TF.html#t:Insertion">Insertion</a></code> witnesses that a table is being <code>INSERT</code>ed. This adds special
 meaning to <code>PGDefault'</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Default" class="def">Default</a> a</p><div class="doc"><p><code><a href="Opaleye-TF.html#t:Default">Default</a></code> is like <code><a href="file:///nix/store/7hnlpxpmpka84zrhyq7z11bs0q3vgak1-ghc-7.10.2/share/doc/ghc/html/libraries/base-4.8.1.0/Data-Maybe.html#t:Maybe">Maybe</a></code>, but only has meaning in <code>INSERT</code> statements.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Default" class="def">Default</a></td><td class="doc"><p>Use the <code>DEFAULT</code> value for this column.</p></td></tr><tr><td class="src"><a name="v:ProvideValue" class="def">ProvideValue</a> a</td><td class="doc"><p>Override the default value by providing an explicit value.</p></td></tr></table></div></div><h1 id="g:5">Implementation details</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Compose" class="def">Compose</a> f g a</p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Compose" class="def">Compose</a> (f (g a))</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:InterpretPGType" class="def">InterpretPGType</a> :: TyFun <a href="Opaleye-TF.html#t:PGTypes">PGTypes</a> * -&gt; *</p><div class="doc"><p>A defunctionalisation symbol used for mapping of database types to Haskell
 types.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:InterpretNull" class="def">InterpretNull</a> :: k -&gt; *</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Interpret" class="def">Interpret</a> :: k -&gt; *</p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>